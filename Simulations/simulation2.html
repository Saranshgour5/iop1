<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Resistance Temperature Detector</title>
  <link rel="icon" type="image/x-icon" href="../images/lightbulb-solid.svg">
  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous" />

  <script src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
    integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
    crossorigin="anonymous"></script>

  <!-- Font-Awesome -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
  <script src="https://kit.fontawesome.com/dcc924776f.js" crossorigin="anonymous"></script>

  <!-- Js-Plumb -->
  <script src="../node_modules/jsplumb/dist/js/jsplumb.min.js"></script>

  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
    integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" />

  <!-- CSS -->
  <link rel="stylesheet" href="../css/control-panel.css" />
 
</head>

<body>
  <!-- Sidenav-Bar -->
  <div id="mySidenav" class="sidenav">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    <ul>
      <li><a href="#">Overview</a></li>
      <li><a href="#">Theory</a></li>
      <li><a href="../Simulations/simulation1.html">Simulation</a></li>
      <li><a href="#">Conclusion</a></li>
    </ul>
  </div>


  <nav class="navbar">
    <span class="toggle-button" onclick="openNav()">&#9776;</span>
    <a class="navbar-brand" href="../index.html">Applied Instrumentation Simulation Lab</a>
  </nav>

  <script>
    function openNav() {
      document.getElementById("mySidenav").style.width = "250px";
      document.getElementById("main").style.marginLeft = "250px";
    }

    function closeNav() {
      document.getElementById("mySidenav").style.width = "0";
      document.getElementById("main").style.marginLeft = "0";
    }
  </script>

  <h2 class="experiment-heading">Resistance Temperature Detector</h2>

  <div class="main-content">
    <div class="row">
      <div class="col-md-1"></div>
      <div class="col-md-5">
        <img src="../images/RTD.png" alt="" />
      </div>
      <div class="col-md-5">
        <h2 style="color: black;">Control Panel</h2>

        <!-- Dropdown -->
        <div class="row-panel">
          <p class="row-text">Material:</p>
          <div class="dropdown btn-group">
            <select id="material" class="btn btn-dark" onchange="return myFunction();">
              <option value="Select">-- Select-- </option>
              <option value="Platinum">Platinum</option>
              <option value="Copper">Copper</option>
              <option value="Nickel">Nickel</option>
              <option value="Balco">Balco</option>
            </select>
          </div>
        </div>

        <!-- alpha-value and temperature range -->
        <div id="alpha-value" class="text-prompt-box">
        </div>
        <div id="temperature-range" class="text-prompt-box">

        </div>
        
        <!-- Dropdown -->
        <div class="row-panel">
          <p class="row-text">R <sub>o</sub>:</p>
          <select id="R0" class="btn btn-dark">
            <option value="">-- Select -- </option>
            <option value="100">100</option>
            <option value="200">200</option>
            <option value="300">300</option>
            <option value="500">500</option>
          </select>
        </div>
        
        <!-- Get-temperature-row -->
        <div class="row-panel">
          <div class="row-text">
            <button name="data" type="button" onclick="getTemperature()" class="btn btn-success">Get temperature</button>
          </div>
          <input readonly type="textf" id="ptemp" class="data-display-box">
        </div>


        <div class="formula-row">
          <button name="formula" type="button" onclick="Start()" class="btn btn-dark">Formula</button>
        </div>
        <div class="row-panel">
          <p>Enter Output R <sub>t</sub> value: </p>
          <div class="form-group">
            <input class="form" tpye="text" id="calculated-value">
          </div>
        </div>
        <div id="pmate" class="text-prompt-box">

        </div>
        <div class=" last-row">
          <button name="Next Set Value" type="button" onclick="getTemperature()" class="btn btn-info">Next set value</button>
          <button name="Plot" type="button" onclick="sendvalue()" class="btn btn-info">Plot</button>
          <button name="submit" type="button" onclick="checkvalue()" class="btn btn-info">Submit</button>
        </div>


      </div>
    </div>
    <div class="col-md-1"></div>
  </div>
  </div>
  <script>
    let gttemp
    let alpha
    var array1=[];
    var array2=[]; 

    function myFunction() {
    var ele = document.getElementById("material");
    var selectedValue = ele.options[ele.selectedIndex].value;

    var x=document.getElementById("temperature-range");
    var y = document.getElementById("alpha-value");
    if(selectedValue=="Platinum"){
       y.innerHTML = "&#945: 0.00385";
       x.innerHTML=" Temperature range: -200 to 800 &#x2103";
    }
    else if(selectedValue=="Copper"){
      y.innerHTML = "&#945: 0.00427";
      x.innerHTML=" Temperature range: -100 to 260 &#x2103";
    }
    else if(selectedValue=="Nickel"){
      y.innerHTML = "&#945: 0.00672";
      x.innerHTML=" Temperature range: -100 to 260 &#x2103";
    }
    else if(selectedValue=="Balco"){
      y.innerHTML = "&#945: 0.00518";
      x.innerHTML=" Temperature range: -100 to 204 &#x2103";
    }
}
    function Start() {
      window.alert("Equation For Calculating Rt\nRt = R0 (1 + α * ΔT)\nWhere\nRt is resistance at measurement temperature\nR0 is resistance at reference (0°C) temperature\nα is temperature co-efficient of material\nΔT is the difference between measurement and reference temperature")
    }
    function getTemperature() {
      document.getElementById("calculated-value").value="";
      let ltemp
      let utemp
      let tempf
      let selectdrp1 = document.getElementById("material")
      let material = selectdrp1.options[selectdrp1.selectedIndex].text;
      if (material == "Platinum") {
        ltemp = -200
        utemp = 800
        alpha = 0.00385
      }
      if (material == "Copper") {
        ltemp = -100
        utemp = 260
        alpha = 0.00427
      }
      if (material == "Nickel") {
        ltemp = -100
        utemp = 260
        alpha = 0.00672
      }
      if (material == "Balco") {
        ltemp = -100
        utemp = 204
        alpha = 0.00518
      }

      tempf = Math.ceil(Math.random() * (utemp - ltemp) + ltemp);
      document.getElementById("ptemp").value = tempf
      gttemp = tempf
    }


    function checkvalue() {
      let selectdrop2 = document.getElementById("R0")
      let rnot = selectdrop2.options[selectdrop2.selectedIndex].value
      let rtnot = rnot * (1 + alpha * gttemp)
      let rinput = document.getElementById("calculated-value").value
      if (rinput >= (rtnot - 0.5) && rinput <= (rtnot + 0.5))
      {
        document.getElementById("pmate").innerHTML = "Your result is correct";
        array1.push(rinput);
        array2.push(gttemp);
      }
      else {
        document.getElementById("pmate").innerHTML = "Try again, your result is incorrect";
      }

    }
    function sendvalue(){
      sessionStorage.setItem('TheArray',array1);
      window.location.href='../charts/simulation2-chart.html';

      sessionStorage.setItem('TheArray2',array2);
      window.location.href='../charts/simulation2-chart.html';

    }
  </script>

</body>

</html>